/*
Name: Thomas Coons
Script Name: Lab5
Date: October 19th 2024
Statement of Authorship: I, Thomas Coons, student number 000317961, certify that this material is my original work. 
						 No other person's work has been used without due acknowledgment and I have not made my work available to anyone else.
*/

USE chdb;

--PRINT 'GROUP 1 SELECT A'
--GO

--SELECT COUNT(birth_date)
--FROM patients
--WHERE YEAR(birth_date) >= (SELECT YEAR(GETDATE()) - 18);

--PRINT 'GROUP 1 SELECT B'
--GO

--SELECT COUNT(patient_weight)
--FROM patients
--WHERE (gender = 'M') AND patient_weight < (SELECT AVG(patient_weight) FROM patients WHERE gender = 'F');

--PRINT 'GROUP 2 SELECT C'
--GO

--SELECT province_id, COUNT(*) AS patient_count_from_provinces_that_are_not_ontario
--FROM patients
--WHERE province_id != 'ON'
--GROUP BY province_id;

--PRINT 'GROUP 2 SELECT D'
--GO

--SELECT gender, COUNT(*) AS patients_taller_than_175cm
--FROM patients
--WHERE patient_height > 175
--GROUP BY gender

--PRINT 'GROUP 3 SELECT D'
--GO

--SELECT dep.department_id, dep.department_name, dep.manager_first_name, dep.manager_last_name, pur.purchase_order_id, pur.total_amount
--FROM departments AS dep
--JOIN purchase_orders AS pur
--ON dep.department_id = pur.department_id
--WHERE pur.total_amount > 1500
--ORDER BY department_id ASC;

--PRINT 'GROUP 3 SELECT A'
--GO

--SELECT p.patient_id, p.first_name, p.last_name, a.room, a.bed
--FROM patients AS p
--JOIN admissions AS a
--ON p.patient_id = a.patient_id
--WHERE a.discharge_date IS NULL AND a.nursing_unit_id = '2SOUTH'
--ORDER BY p.last_name ASC;

--PRINT 'GROUP 4 SELECT A'
--GO

--SELECT py.physician_id, py.first_name, py.last_name, py.specialty, pa.first_name AS patient_first_name, en.encounter_id
--FROM physicians AS py
--JOIN encounters AS en
--ON py.physician_id = en.physician_id
--JOIN patients AS pa
--ON en.patient_id = pa.patient_id
--WHERE pa.first_name = 'Walter' AND pa.last_name = 'Mitty'

--PRINT 'GROUP 4 SELECT D'
--GO

--SELECT pur.purchase_order_id, pur.order_date, it.order_quantity, it.item_id, it.item_description
--FROM purchase_orders AS pur
--JOIN purchase_order_lines AS pur_line
--ON pur.purchase_order_id = pur_line.purchase_order_id
--JOIN items AS it
--ON pur_line.item_id = it.item_id
--WHERE pur.order_status = 'ACTIVE' AND pur_line.received = 0;

--PRINT 'GROUP 5 SELECT A'
--GO

--SELECT py.first_name + ' ' + py.last_name AS physician, nu.specialty, pa.first_name + ' ' + pa.last_name AS patient, ad.primary_diagnosis
--FROM physicians AS py
--JOIN admissions AS ad
--ON py.physician_id = ad.attending_physician_id
--JOIN nursing_units AS nu
--ON nu.nursing_unit_id = ad.nursing_unit_id
--JOIN patients AS pa
--ON pa.patient_id = ad.patient_id
--WHERE ad.discharge_date IS NULL AND ad.secondary_diagnoses IS NULL

PRINT 'GROUP 6 SELECT B'
GO

--SELECT pa.patient_id, ad.primary_diagnosis, ad.attending_physician_id
--FROM patients AS pa
--JOIN admissions AS ad 
--ON ad.patient_id = pa.patient_id
--JOIN nursing_units AS nu 
--ON nu.nursing_unit_id = ad.nursing_unit_id
--WHERE ad.discharge_date IS NULL AND nu.nursing_unit_id = 'ICU' AND NOT EXISTS (SELECT 1 FROM encounters AS en WHERE en.patient_id = pa.patient_id AND en.physician_id = ad.attending_physician_id);







